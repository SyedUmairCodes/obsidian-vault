Welcome to lesson two of module five on extended query formulation with SQL. I'm going to start with an important question to check your work on problems involving joins of more than two tables. How does a statement pattern help you to avoid a serious error and query formulation? Lesson one provided guidelines to extend your problem solving skills to more realistic queries. This lesson will provide more realistic problems involving multiple tables along with statement patterns to augment the problem solving guidelines. The objectives in this lesson relate to solving more complex problems with multiple JOIN operations. First, you should be able to use the critical questions to analyze more complex problem statements. As you gain confidence with more difficult problems, you should be able to use the critical questions implicitly while writing select statements. Second, you should apply a statement pattern to write select statements for more complex problems involving more than two tables. Third, you should analyze select statements using the statement pattern for major query formulation errors, you should be very familiar with the university database diagram from past lessons. The examples in this lesson involve three, four and five tables connected by relationships. After identifying required tables for a problem, you should use the university database diagram to understand the connections. For example, to combine the faculty and student tables, you need to use offering enrollment tables as the faculty and student tables are not directly connected. The statement pattern for the cross product Join style shows end tables in the from clause and N minus 1 join conditions in the where clause. Note, that join conditions proceed other row conditions in the where clause as reinforcement about the importance of not missing joint conditions. If a problem requires or conditions, parentheses should surround row conditions connected by the or operator. The statement pattern for the joint operator style shows N minus 1 joint operations in the from clause, to combine end tables. The where clause omits join conditions as the from clause contains details of join operations. If a problem requires or conditions, parentheses should surround row conditions connected by the or operator. Now, let's use the critical questions on example one answering the questions before reviewing the associated select statement. What tables? The faculty table is needed because of a condition on faculty name Leonard Vince. The offering table is needed because of conditions on offering year and term as well as columns and results, offering days, location and time. The course table is needed because course units is required in the result. How our tables combine. The offering and faculty tables must be joined on FacNo using the condition with the primary key foreign key of the tables. The offering and course tables must be joined on CourseNo using this condition with the primary key, foreign key of the tables. Individual rows versus groups of rows. Individual rows are needed as a problem statement does not mention aggregate functions in the result or conditions. The select statement shows the cross product style to combine the faculty, course and offering tables. The where clauses is to join conditions and conditions are offering, year and term and faculty first and last names. See the module five examples for an equivalent statement using the join operator style. Let's use the critical questions on example two, answering the questions before reviewing the associated select statement. What tables? The student table is needed because of a condition on student name for Bob Norbert. The offering table is needed because of conditions and offering year and term as well as columns and results, offering days, location and time. The faculty table is needed because faculty name is in the result. The enrollment table is needed to connect the student offering tables. The course table is not needed because the offering table provides CourseNo column and offering CourseNo does not have no values. How our tables combine. The offering enrollment tables must be joined in offer number using a condition with a primary key, foreign key of the tables. The student enrollment tables must be joined as student number using a condition with the primary key, foreign key of the tables. The faculty and offering tables are joined on FacNo using a condition with the primary key, foreign key of the tables. Individual rows versus groups of rows. Individual rows are needed as a problem statement does not mention aggregate functions in the result or conditions.
Play video starting at :5:44 and follow transcript5:44
The select statement shows the cross product style to combine the faculty, offering, enrollment and student tables. The where clauses has three joint conditions and conditions on offering year and term and student first and last names. If you omit a joint condition, the statement will provide incorrect results and consume large amounts of computing resources. See the module five examples, for an equivalent statement using the join operator style. Example three is a slight variation of example two. The only difference is that course units should be shown in the result in addition to the other columns in example two. This new requirement means that the course table must be used in the from clause to provide the course units column. The answers to the critical questions are the same in problem three as problem two, except for details about the course table in question one in the joint of course and offering in question two. The select statement for example three is identical to the select statement for example two, except for the course units column and result and the usage of the course table in the from clause and where clause. The from clause contains five tables, course, faculty, offering, enrollment and student. The where clauses has four join conditions and conditions and offering year and term and student first and last names. If you omit a join condition, the statement will provide incorrect results and consume large amounts of computing resources. See the module five examples for an equivalent statement using the join operator style.
Play video starting at :7:42 and follow transcript7:42
Let's wrap up lesson two about problems involving multiple tables. The lesson demonstrated analysis of problem statements using the critical questions and then the formulation of problems using the statement pattern with the cross product joint style. You solved problems involving three, four and five tables, as well as conditions on individual tables. Some of the tables and the solutions were needed just to connect other tables, rather than providing columns and results or conditions to test. In answer to the opening question, the statement patterns ensure the correct number of join conditions or join operations to combine tables. The statement patterns indicate that each statement contains one less joint condition, a join operation and a number of tables, so that a statement with five tables has four joint conditions. Missing a join condition is a serious error causing a cross product operation instead of a join operation. Missing a join condition causes incorrect rows in the result, as well as consumption of a large amount of extra resources. The statement pattern indicates a lower bound a number of joint conditions of joint operations. On some difficult problems, you may need more than N minus 1 join conditions or join operations. But these more difficult Join problems are specialized and not covered in this module.